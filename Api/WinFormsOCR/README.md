# 电子胶片OCR识别工具

一个功能完整的WinForms应用，支持图片和DICOM电子胶片的OCR识别。

## 功能特性

- ✅ **支持多种图片格式**：JPG, JPEG, PNG, BMP, TIFF
- ✅ **DICOM文件提示**：检测到DICOM文件时会提示用户需要先转换为图片
- ✅ **全图识别**：识别整张图片的所有文字
- ✅ **区域识别**：支持鼠标拖拽选择指定区域进行识别
- ✅ **多语言支持**：中英文混合识别
- ✅ **可视化选择**：实时显示选择框
- ✅ **详细结果**：显示置信度、识别内容等详细信息

## 系统要求

- Windows 10 或更高版本
- .NET 8.0 Runtime
- Tesseract OCR 训练数据（已包含在项目中）

## 安装依赖

项目会自动安装以下NuGet包：

- **Tesseract** (5.2.0) - OCR引擎

## 依赖项说明

- **Tesseract OCR**: 用于文字识别
- **Tesseract训练数据**: 
  - `chi_sim.traineddata` - 简体中文识别
  - `eng.traineddata` - 英文识别

## 使用方法

### 1. 打开文件

点击"打开文件"按钮，选择要识别的图片文件。

- 支持格式：
  - 图片：`.jpg`, `.jpeg`, `.png`, `.bmp`, `.tiff`
  - DICOM：`.dcm`（会提示用户需要先转换为图片）

### 2. 识别全部内容

1. 打开图片或DICOM文件后，点击"识别全部"按钮
2. 等待识别完成
3. 查看底部文本区域显示的识别结果

### 3. 区域识别

1. 打开图片后，在图片上按住鼠标左键拖拽，框选要识别的区域
2. 释放鼠标，形成选择框
3. 点击"区域识别"按钮
4. 查看指定区域的识别结果

## 界面说明

- **上部工具栏**：
  - 打开文件：选择要识别的文件
  - 识别全部：识别整张图片
  - 区域识别：识别选择的区域
  - 文件信息：显示当前文件的基本信息

- **中部图片区域**：
  - 显示加载的图片
  - 支持鼠标拖拽选择识别区域

- **下部结果区域**：
  - 显示OCR识别结果
  - 包括置信度、处理时间等信息
  - 支持滚动查看长文本

## 技术实现

### DICOM文件处理

程序检测到DICOM文件时会提示用户需要先转换为图片格式，然后才能进行OCR识别。

### OCR识别

使用 `Tesseract OCR` 引擎进行文字识别：

- 支持中英文混合识别（chi_sim+eng）
- 针对医疗影像优化了参数设置
- 自动预处理图片以提升识别准确率

### 区域选择

实现了鼠标事件处理机制：

- `MouseDown`: 开始选择
- `MouseMove`: 实时更新选择框
- `MouseUp`: 完成选择
- `Paint`: 绘制选择框

## 故障排除

### 识别效果不佳

1. **调整图片质量**：确保图片清晰、对比度高
2. **手动选择区域**：使用区域识别功能，只识别关键部分
3. **检查字体**：Tesseract对某些特殊字体的识别率较低

### DICOM转换失败

- 检查DICOM文件是否完整
- 确保文件是有效的DICOM格式
- 检查磁盘空间是否充足

### 无法识别中文

- 确保 `tessdata` 文件夹中存在 `chi_sim.traineddata` 文件
- 重新下载中文训练数据

## 开发信息

- 开发框架：WinForms
- .NET版本：8.0
- 平台：Windows

## 许可证

本项目为医院打印系统的一部分，遵循项目整体许可证。
