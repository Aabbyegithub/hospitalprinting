# 条码打印捕获版 v1.1.1

## 功能说明

这是一个用于从其他WinForm应用程序窗口中捕获信息并打印条码的工具。

### 主要功能

1. **窗口信息捕获**：通过进程名、窗口标题、类名等定位目标窗口
2. **信息获取**：能够获取指定控件的位置和内容（ID、姓名等）
3. **自动定时打印**：监控目标窗口，当内容发生变化时自动打印条码
4. **悬停窗口打印**：提供悬停窗口，手动选择需要打印的项
5. **配置管理**：保存和加载配置，包括医院名称、打印机等设置

## 使用说明

### 1. 获取信息

1. 在"获取信息"区域填写筛选条件：
   - **进程名**：目标进程的名称（如：ceshi）
   - **窗口标题**：窗口标题（可选）
   - **子窗口类名**：控件类名（可选）
   - **Id内容**：ID控件的内容（可选）
   - **姓名**：姓名控件的内容（可选）

2. 点击"获取信息"按钮，程序会搜索符合条件的窗口并显示所有子控件

3. 在结果列表中：
   - 选择一个ID项，会自动提取坐标并填入"Id窗口坐标"
   - 选择一个姓名项，会自动提取坐标并填入"姓名窗口坐标"

### 2. 配置设置

在"配置"区域设置以下参数：

- **进程名**：要监控的进程名
- **窗口标题**：窗口标题
- **子窗口类名**：控件类名
- **Id窗口坐标**：ID控件的位置（格式：x,y）
- **姓名窗口坐标**：姓名控件的位置（格式：x,y）
- **自动定时打印**：是否启用自动定时打印
  - **运行间隔**：检查的时间间隔（秒）
- **打印登记时间**：是否在条码上打印登记时间
- **悬停窗点击打印**：是否显示悬停窗口用于手动打印
- **医院名称**：显示在条码上的医院名称
- **条码打印机**：选择用于打印的打印机

### 3. 保存配置

点击"保存配置"按钮保存设置。保存后：
- 如果启用了"悬停窗点击打印"，会显示悬停窗口
- 如果启用了"自动定时打印"，会启动定时监控

### 4. 自动打印

当启用了"自动定时打印"后：
- 程序会按设定的时间间隔搜索目标窗口
- 获取指定坐标处的控件内容（ID和姓名）
- 当内容发生变化时，自动打印条码

### 5. 悬停窗口

悬停窗口显示最近的三条姓名的记录：
- 姓名会从下往上变化
- 默认自动勾选最新的姓名
- 可以手动勾选不同的姓名
- 点击"打印条码"按钮打印选中的姓名对应的条码

## 技术实现

- **WindowCaptureHelper.cs**：窗口捕获辅助类，使用Win32 API枚举窗口和子控件
- **BarcodePrintHelper.cs**：条码打印辅助类，使用GDI+绘制条码并打印
- **FormBarcodeCapture.cs**：主配置窗体
- **FormHoverWindow.cs**：悬停窗口窗体

## 注意事项

1. 程序需要管理员权限才能捕获其他窗口的信息
2. 确保打印机已正确安装并配置
3. 坐标格式必须正确（格式：x,y）
4. 自动打印功能会持续运行，直到关闭程序或禁用该功能

## 版本信息

- 版本：1.1.1
- 开发环境：.NET Framework 4.6.1
- 开发语言：C#

